<header>
  <nav class="navbar navbar-expand-md navbar-dark bg-success">
    <a class="navbar-brand" href="/urls">TinyApp</a>
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="navbarNavAltMarkup">
      <div class="navbar-nav">
        <a class="nav-item nav-link" href="/urls">My URLs</a>
        <a class="nav-item nav-link" href="/urls/new">Create a New Short Link</a>
      </div>
    </div>
    <button onclick="clickHandler()" style="padding-right: 10px" class="btn btn-warning">Theme</button>
    <% if (user) { %>
      <form method="POST" action="/logout?_method=PUT">
        <span style="padding-right: 10px">Logged in as: <%= user.email %></span>
        <button type="submit" class="btn btn-primary">Logout</button>
      </form>
    <% } else { %>
      <div class="navbar-nav">
        <a class="nav-item nav-link" href="/register">Register</a>
        <a class="nav-item nav-link" href="/login">Login</a>
      </div>
    <% } %>
  </nav>
</header>

<script>
  if (localStorage.getItem('data-theme') === null) {
    localStorage.setItem("data-theme", "dark");
  }
  
  let theme = localStorage.getItem('data-theme');

  const changeThemeToDark = () => {
    document.body.classList.add("bg-dark");
    localStorage.setItem("data-theme", "dark");
  }

  const changeThemeToLight = () => {
    document.body.classList.remove("bg-dark");
    localStorage.setItem("data-theme", "light");
  }
  
  const clickHandler = () => {
    if (theme === "light") {
      changeThemeToDark();
    } else if (theme === "dark") {
      changeThemeToLight();
    }
    theme = localStorage.getItem('data-theme');
  }

  const checkTheme = () => {
    if (theme === "light") {
      changeThemeToLight();
    } else if (theme === "dark") {
      changeThemeToDark();
    }
    theme = localStorage.getItem('data-theme');
  }

  checkTheme();
</script>